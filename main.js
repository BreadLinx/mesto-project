(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",o)}function n(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",o)}function o(e){"Escape"===e.key&&n(document.querySelector(".popup_opened"))}function r(e,o,r,c){function i(t){t.preventDefault(),A.textContent="Удаление...",function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-13/cards/".concat(e),{method:"DELETE",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179","Content-Type":"application/json"}})}(c).then((function(){r.remove(),d(),l(),A.textContent="Удалено",n(e),A.textContent="Да"})).catch((function(e){console.log(e),d(),l()}))}function u(e){"delete-action-submit-popup"===e.target.id&&(l(),d())}function a(e){"Escape"===e.key&&(l(),d())}function s(){l(),d()}function l(){e.removeEventListener("submit",i)}function d(){o.removeEventListener("mousedown",s),e.removeEventListener("mousedown",u),document.removeEventListener("keydown",a)}e.addEventListener("submit",i),e.addEventListener("mousedown",u),document.addEventListener("keydown",a),o.addEventListener("mousedown",s),t(e)}function c(e,n,o,c,i){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=document.querySelector("#card-template").content.cloneNode(!0);l.id=i;var d=l.querySelector(".card__photo");d.src=n,d.alt="Изображние показывающее ".concat(e),d.addEventListener("click",(function(){t(k),g.src=n,g.alt="Изображние показывающее ".concat(e),x.textContent=e})),l.querySelector(".card__description").textContent=e;var p=l.querySelector(".card__like");!0===s&&p.classList.add("card__like_active"),p.addEventListener("click",(function(e){var t=l.id,n=e.target.closest(".card");e.target.classList.contains("card__like_active")?a(n,t):u(n,t)}));var f=l.querySelector(".card__likes-counter");f.textContent=o;var m=l.querySelector(".card__delete-button");return"3aa69ff877e5d2e63a6e38fc"===c?m.addEventListener("click",(function(e){var t=e.target.closest(".card"),n=l.id;r(j,T,t,n)})):m.remove(),l}function i(e){E.append(e)}function u(e,t){(function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-13/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179","Content-Type":"application/json"}})})(t).then((function(e){return e.json()})).then((function(t){e.querySelector(".card__like").classList.add("card__like_active"),e.querySelector(".card__likes-counter").textContent=t.likes.length})).catch((function(e){console.log(e)}))}function a(e,t){(function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-13/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179","Content-Type":"application/json"}})})(t).then((function(e){return e.json()})).then((function(t){e.querySelector(".card__like").classList.remove("card__like_active"),e.querySelector(".card__likes-counter").textContent=t.likes.length})).catch((function(e){console.log(e)}))}e.d({},{Pm:()=>q,Zw:()=>C,n_:()=>_,AU:()=>y,_u:()=>E,gg:()=>j,ro:()=>T,Po:()=>A,s1:()=>f,iX:()=>v,fS:()=>l,V:()=>d,NT:()=>k,e2:()=>g,vi:()=>x,f:()=>w,xG:()=>b,rC:()=>m,Hs:()=>z,iR:()=>P});var s=document.querySelector(".profile__edit-button"),l=document.querySelector("#edit-profile-popup"),d=l.querySelector(".popup__submit"),p=document.querySelector("#edit-profile-form"),f=document.querySelector("#input-name"),m=document.querySelector(".profile__name"),v=document.querySelector("#input-work"),b=document.querySelector(".profile__info-about"),h=document.querySelector(".profile__add-button"),_=document.querySelector("#add-new-popup"),y=_.querySelector(".popup__submit"),S=document.querySelector("#add-new-form"),q=document.querySelector("#input-new-place"),C=document.querySelector("#input-new-place-link"),E=document.querySelector(".elements"),L=document.querySelectorAll(".popup"),k=document.querySelector("#photo-popup"),g=k.querySelector(".popup__image"),x=k.querySelector(".popup__description"),w=document.querySelector(".profile__avatar"),j=document.querySelector("#delete-action-submit-popup"),T=j.querySelector(".popup__close-icon"),A=j.querySelector(".popup__submit"),O=document.querySelector(".profile__avatar-overlay"),z=document.querySelector("#upload-new-avatar-popup"),P=z.querySelector(".popup__submit"),D=document.querySelector("#upload-new-avatar-form"),B=document.querySelector("#input-upload-avatar");fetch("https://nomoreparties.co/v1/plus-cohort-13/users/me",{method:"GET",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179"}}).then((function(e){return e.json()})).then((function(e){m.textContent=e.name,b.textContent=e.about,w.src=e.avatar})).catch((function(e){console.log("Ошибка при попытке загрузки профиля.")})),fetch("https://nomoreparties.co/v1/plus-cohort-13/cards",{method:"GET",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179"}}).then((function(e){return e.json()})).then((function(e){e.forEach((function(e){if(0===e.likes.length)i(c(e.name,e.link,e.likes.length,e.owner._id,e._id,!1));else{var t=e.likes.some((function(e){return"3aa69ff877e5d2e63a6e38fc"===e._id}));i(c(e.name,e.link,e.likes.length,e.owner._id,e._id,t))}}))})).catch((function(e){console.log("Ошибка при попытке загрузки карточек.")})),L.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&n(e),t.target.classList.contains("popup__close-icon")&&n(e)}))})),s.addEventListener("click",(function(){f.value=m.textContent,v.value=b.textContent,t(l)})),p.addEventListener("submit",(function(e){var t,o;e.preventDefault(),d.textContent="Сохранение...",(t=f.value,o=v.value,fetch("https://nomoreparties.co/v1/plus-cohort-13/users/me",{method:"PATCH",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179","Content-Type":"application/json"},body:JSON.stringify({name:t,about:o})})).then((function(e){return e.json()})).then((function(e){m.textContent=e.name,b.textContent=e.about,d.textContent="Сохранено"})).then((function(){n(l),d.textContent="Сохранить"})).catch((function(e){console.log(e)}))})),h.addEventListener("click",(function(){t(_)})),S.addEventListener("submit",(function(e){var t,o;e.preventDefault(),""!==q.value&&""!==C.value&&(y.textContent="Сохранение...",(t=q.value,o=C.value,fetch("https://nomoreparties.co/v1/plus-cohort-13/cards",{method:"POST",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179","Content-Type":"application/json"},body:JSON.stringify({name:t,link:o})})).then((function(e){return e.json()})).then((function(e){E.prepend(c(e.name,e.link,e.likes.length,e.owner._id,e._id,!1))})).then((function(){y.textContent="Сохранено",n(_),y.textContent="Создать"})).catch((function(e){console.log(e)})))})),O.addEventListener("click",(function(){t(z)})),D.addEventListener("submit",(function(e){var t;e.preventDefault(),t=B.value,P.textContent="Сохранение...",function(e){return fetch("https://nomoreparties.co/v1/plus-cohort-13/users/me/avatar",{method:"PATCH",headers:{authorization:"d0237f44-6bee-4b11-b7b4-b67bb1856179","Content-Type":"application/json"},body:JSON.stringify({avatar:e})})}(t).then((function(e){return e.json()})).then((function(e){w.src=e.avatar,P.textContent="Сохранено",n(z),P.textContent="Сохранить"})).catch((function(e){console.log(e)})),D.reset()})),function(e){function t(t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?(n.classList.remove(e.submitButtonInactiveClass),n.removeAttribute("disabled",0)):(n.classList.add(e.submitButtonInactiveClass),n.setAttribute("disabled",0))}Array.from(document.querySelectorAll(e.formSelector)).forEach((function(n){!function(n){var o=Array.from(n.querySelectorAll(e.inputSelector)),r=n.querySelector(e.submitButtonSelector);n.addEventListener("submit",(function(e){e.preventDefault(),n.reset(),t(o,r)})),t(o,r),o.forEach((function(c){c.addEventListener("input",(function(){!function(t,n){n.validity.valid?function(t,n){var o=t.querySelector("#".concat(n.id,"-span"));n.classList.remove(e.inputErrorClass),o.classList.remove(e.errorSpanOpenedClass),o.textContent=""}(t,n):function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"В поле ввода допущена ошибка",r=t.querySelector("#".concat(n.id,"-span"));n.classList.add(e.inputErrorClass),r.textContent=o,r.classList.add(e.errorSpanOpenedClass)}(t,n,n.validationMessage)}(n,c),t(o,r)}))}))}(n)}))}({formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",submitButtonInactiveClass:"popup__submit_disabled",inputErrorClass:"popup__input_error",errorSpanOpenedClass:"popup__error-message_opened"})})();